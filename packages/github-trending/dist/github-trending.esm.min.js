/*!
 * @githubjs/github-trending v1.1.6
 * (c) 2014-2020 Ying Wang <upcwangying@gmail.com> (https://github.com/upcwangying)
 * Released under the MIT License.
 */
function e(e,r,n){return r in e?Object.defineProperty(e,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[r]=n,e}function r(e,r){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);r&&(t=t.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),n.push.apply(n,t)}return n}function n(n){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?r(Object(l),!0).forEach((function(r){e(n,r,l[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):r(Object(l)).forEach((function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(l,e))}))}return n}var t=require("request-promise"),l=require("cheerio"),a=require("./constant/trending-since"),i=require("./constant/trending-type"),o=require("./model/index.js"),c=o.TrendingRepository,u=o.PrimaryLanguage,s=o.RepositoryBuildBy,p=o.TrendingDeveloper,g=o.PopularRepository,m="https://github.com",d={uri:"".concat(m,"/trending"),transform:function(e){return l.load(e)}};module.exports={TrendingRepository:c,PrimaryLanguage:u,RepositoryBuildBy:s,TrendingDeveloper:p,PopularRepository:g,TrendingSince:a,TrendingType:i,getTrendingRepositories:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.since,l=e.language;return new Promise((function(e,a){var i="".concat(m,"/trending");l&&(i+="/".concat(l)),r&&(i+="?since=".concat(r)),t(n({},d,{uri:i})).then((function(r){if(r){var n=[];r(".Box-row").each((function(e,t){var l,a=r(".repo-language-color",t);if(null!=a){var i=new RegExp("#[0-9a-fA-F]{3,6}").exec(r(a).attr("style")),o=r(a).next(),p=null==o||null==o.html()?null:o.html();l=new u({name:null==p?null:p.trim(),color:null==i?null:i[0]})}var g,d=r(".f6 .muted-link .octicon-star",t);null!=d&&(g=r(d).parent().html().replace(/^[\s\S]*svg>/g,"").replace(/,/g,""));var v,f=null==g?null:parseInt(g.trim(),10),h=r(".f6 .octicon-repo-forked",t);null!=h&&(v=r(h).parent().html().replace(/^[\s\S]*svg>/g,"").replace(/,/g,""));var y,b,w,O=null==v?null:parseInt(v.trim(),10),j=r(".float-sm-right",t);null!=j&&(y=r(j).html().replace(/^[\s\S]*svg>/g,"").replace(/,/g,"").trim());var P=r("p",t),x=null==P?null:P.html();null!=(x=null==x?null:x.trim())&&(b=x.replace(/<g-emoji.*?>/g,"").replace(/<\/g-emoji>/g,"").replace(/<a.*?>/g,"").replace(/<\/a>/g,"").trim(),w="<div>".concat(x,"</div>"));var R=[],T=r(".avatar",t);null!=T&&T.length>0&&T.each((function(e,n){R.push(new s({avatar:r(n).attr("src"),username:r(n).attr("alt").replace(/@/g,"")}))}));var B,D=r(".text-normal",t);D&&(B=D.html().replace("/","").trim());var S,k=r(".text-normal",t);k&&(S=k.parent().html().replace(/[\s\S]*span>/g,"").trim()),n.push(new c({owner:B,avatar:"".concat(m,"/").concat(B,".png"),name:S,description:b,descriptionHTML:w,starCount:f,forkCount:O,stars:y,primaryLanguage:l,buildBys:R}))})),e(n)}else a("response is null!")})).catch((function(e){a(e)}))}))},getTrendingDevelopers:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.since,l=e.language;return new Promise((function(e,a){var i="".concat(m,"/trending/developers");l&&(i+="/".concat(l)),r&&(i+="?since=".concat(r)),t(n({},d,{uri:i})).then((function(r){if(r){var n=[];r(".Box-row").each((function(e,t){var l,a=r(".d-sm-flex .col-md-6",t),i=null==a?null:a.last();if(null!=i){var o,c,u=r(".mt-1",i),s=null==u?null:u.html();null!=(s=null==s?null:s.trim())&&(o=s.replace(/<g-emoji.*?>/g,"").replace(/<\/g-emoji>/g,"").replace(/<a.*?>/g,"").replace(/<\/a>/g,"").trim(),c="<div>".concat(s,"</div>"));var m,d=r("div>article>h1>a",i),v=null==d?null:r(d).attr("href");d&&(m=r(d).text().trim()),l=new g({url:v,name:m,description:o,descriptionRawHtml:c})}var f,h,y,b=r(".rounded-1",t),w=r(".link-gray",t),O=r(".d-md-flex",t);b&&(f=r(b).attr("src").trim()),w&&(h=r(w).html().trim()),O&&(y=r(".lh-condensed",O).children().first().text().trim()),n.push(new p({avatar:f,username:h,nickname:y,popularRepository:l}))})),e(n)}else a("response is null!")})).catch((function(e){a(e)}))}))}};
